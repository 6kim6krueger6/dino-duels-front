"use strict";(self.webpackChunkprivy_create_react_app=self.webpackChunkprivy_create_react_app||[]).push([[122],{7122:function(e,t,r){r.r(t),r.d(t,{WebAuthnAbortService:function(){return A},WebAuthnError:function(){return b},base64URLStringToBuffer:function(){return h},browserSupportsWebAuthn:function(){return w},browserSupportsWebAuthnAutofill:function(){return S},bufferToBase64URLString:function(){return p},platformAuthenticatorIsAvailable:function(){return N},startAuthentication:function(){return C},startRegistration:function(){return y}});var n=r(4165),a=r(5861),o=r(3144),i=r(5671),s=r(136),c=r(9388),u=r(8737),l=r(1413),d=r(7762);function f(e){return(new TextEncoder).encode(e)}function p(e){var t,r=new Uint8Array(e),n="",a=(0,d.Z)(r);try{for(a.s();!(t=a.n()).done;){var o=t.value;n+=String.fromCharCode(o)}}catch(i){a.e(i)}finally{a.f()}return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function h(e){for(var t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4,n=t.padEnd(t.length+r,"="),a=atob(n),o=new ArrayBuffer(a.length),i=new Uint8Array(o),s=0;s<a.length;s++)i[s]=a.charCodeAt(s);return o}function w(){var e;return void 0!==(null===(e=window)||void 0===e?void 0:e.PublicKeyCredential)&&"function"===typeof window.PublicKeyCredential}function R(e){var t=e.id;return(0,l.Z)((0,l.Z)({},e),{},{id:h(t),transports:e.transports})}function E(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}var b=function(e){(0,s.Z)(r,e);var t=(0,c.Z)(r);function r(e){var n,a=e.message,o=e.code,s=e.cause,c=e.name;return(0,i.Z)(this,r),(n=t.call(this,a,{cause:s})).name=null!==c&&void 0!==c?c:s.name,n.code=o,n}return(0,o.Z)(r)}((0,u.Z)(Error));function g(e){var t=e.error,r=e.options,n=r.publicKey;if(!n)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(r.signal instanceof AbortSignal)return new b({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if("ConstraintError"===t.name){var a,o;if(!0===(null===(a=n.authenticatorSelection)||void 0===a?void 0:a.requireResidentKey))return new b({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if("required"===(null===(o=n.authenticatorSelection)||void 0===o?void 0:o.userVerification))return new b({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if("InvalidStateError"===t.name)return new b({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if("NotAllowedError"===t.name)return new b({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("NotSupportedError"===t.name)return 0===n.pubKeyCredParams.filter((function(e){return"public-key"===e.type})).length?new b({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new b({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if("SecurityError"===t.name){var i=window.location.hostname;if(!E(i))return new b({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(n.rp.id!==i)return new b({message:'The RP ID "'.concat(n.rp.id,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("TypeError"===t.name){if(n.user.id.byteLength<1||n.user.id.byteLength>64)return new b({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if("UnknownError"===t.name)return new b({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return t}var A=new(function(){function e(){(0,i.Z)(this,e)}return(0,o.Z)(e,[{key:"createNewAbortSignal",value:function(){if(this.controller){var e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}var t=new AbortController;return this.controller=t,t.signal}},{key:"cancelCeremony",value:function(){if(this.controller){var e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}]),e}()),m=["cross-platform","platform"];function v(e){if(e&&!(m.indexOf(e)<0))return e}function y(e){return _.apply(this,arguments)}function _(){return(_=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a,o,i,s,c,u,d,E,b,m,y,_,I;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w()){e.next=2;break}throw new Error("WebAuthn is not supported in this browser");case 2:return a=(0,l.Z)((0,l.Z)({},t),{},{challenge:h(t.challenge),user:(0,l.Z)((0,l.Z)({},t.user),{},{id:f(t.user.id)}),excludeCredentials:null===(r=t.excludeCredentials)||void 0===r?void 0:r.map(R)}),(o={publicKey:a}).signal=A.createNewAbortSignal(),e.prev=5,e.next=8,navigator.credentials.create(o);case 8:i=e.sent,e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(5),g({error:e.t0,options:o});case 14:if(i){e.next=16;break}throw new Error("Registration was not completed");case 16:if(c=(s=i).id,u=s.rawId,d=s.response,E=s.type,b=void 0,"function"===typeof d.getTransports&&(b=d.getTransports()),m=void 0,"function"===typeof d.getPublicKeyAlgorithm)try{m=d.getPublicKeyAlgorithm()}catch(n){O("getPublicKeyAlgorithm()",n)}if(y=void 0,"function"===typeof d.getPublicKey)try{null!==(_=d.getPublicKey())&&(y=p(_))}catch(n){O("getPublicKey()",n)}if("function"===typeof d.getAuthenticatorData)try{I=p(d.getAuthenticatorData())}catch(n){O("getAuthenticatorData()",n)}return e.abrupt("return",{id:c,rawId:p(u),response:{attestationObject:p(d.attestationObject),clientDataJSON:p(d.clientDataJSON),transports:b,publicKeyAlgorithm:m,publicKey:y,authenticatorData:I},type:E,clientExtensionResults:i.getClientExtensionResults(),authenticatorAttachment:v(i.authenticatorAttachment)});case 25:case"end":return e.stop()}}),e,null,[[5,11]])})))).apply(this,arguments)}function O(e,t){console.warn("The browser extension that intercepted this WebAuthn API call incorrectly implemented ".concat(e,". You should report this error to them.\n"),t)}function I(e){return new TextDecoder("utf-8").decode(e)}function S(){var e=window.PublicKeyCredential;return void 0===e.isConditionalMediationAvailable?new Promise((function(e){return e(!1)})):e.isConditionalMediationAvailable()}function T(e){var t=e.error,r=e.options,n=r.publicKey;if(!n)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(r.signal instanceof AbortSignal)return new b({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if("NotAllowedError"===t.name)return new b({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("SecurityError"===t.name){var a=window.location.hostname;if(!E(a))return new b({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(n.rpId!==a)return new b({message:'The RP ID "'.concat(n.rpId,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("UnknownError"===t.name)return new b({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return t}function C(e){return P.apply(this,arguments)}function P(){return P=(0,a.Z)((0,n.Z)().mark((function e(t){var r,a,o,i,s,c,u,d,f,E,b,g,m,y=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=y.length>1&&void 0!==y[1]&&y[1],w()){e.next=3;break}throw new Error("WebAuthn is not supported in this browser");case 3:if(0!==(null===(r=t.allowCredentials)||void 0===r?void 0:r.length)&&(o=null===(i=t.allowCredentials)||void 0===i?void 0:i.map(R)),s=(0,l.Z)((0,l.Z)({},t),{},{challenge:h(t.challenge),allowCredentials:o}),c={},!a){e.next=16;break}return e.next=9,S();case 9:if(e.sent){e.next=11;break}throw Error("Browser does not support WebAuthn autofill");case 11:if(!(document.querySelectorAll("input[autocomplete$='webauthn']").length<1)){e.next=14;break}throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');case 14:c.mediation="conditional",s.allowCredentials=[];case 16:return c.publicKey=s,c.signal=A.createNewAbortSignal(),e.prev=18,e.next=21,navigator.credentials.get(c);case 21:u=e.sent,e.next=27;break;case 24:throw e.prev=24,e.t0=e.catch(18),T({error:e.t0,options:c});case 27:if(u){e.next=29;break}throw new Error("Authentication was not completed");case 29:return f=(d=u).id,E=d.rawId,b=d.response,g=d.type,m=void 0,b.userHandle&&(m=I(b.userHandle)),e.abrupt("return",{id:f,rawId:p(E),response:{authenticatorData:p(b.authenticatorData),clientDataJSON:p(b.clientDataJSON),signature:p(b.signature),userHandle:m},type:g,clientExtensionResults:u.getClientExtensionResults(),authenticatorAttachment:v(u.authenticatorAttachment)});case 33:case"end":return e.stop()}}),e,null,[[18,24]])}))),P.apply(this,arguments)}function N(){return w()?PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable():new Promise((function(e){return e(!1)}))}}}]);
//# sourceMappingURL=122.458b50c4.chunk.js.map